{{- define "main" -}}

{{ $env := getenv "HUGO_ENV" }}
{{/* <!-- "staging" "production." Staging is hugo server or user defined env --> */}}
{{ with partial "pancakesBuilder/helpers/getEnvironment.html" . }}
   {{ $env = . }}
{{ end }}

{{ partial "pancakesBuilder/scripts_critical.html" . | safeHTML }}

{{ if eq $env "staging" }}
  {{ partial "pancakesBuilder/app/styles.html" . | safeHTML }}
{{ end }}

{{/* <!-- Critical CSS --> */}}
<style pancakes-critical class="pb_criticalCSS">
    {{ partial "components/component_generator.html" . | safeCSS }}
</style>

{{/* <!-- Page HTML --> */}}
{{- partial "components/component_generator.html" . | safeHTML -}}

{{/* <!-- Page Noncritical CSS --> */}}
{{ $yes := false }}
{{ if $yes }}
  {{ $css := partial "components/component_generator.html" . | safeCSS }}
  {{ $string := print $css }}
  {{ $vars := $css | resources.FromString "scss/pb_noncritical.scss" | resources.ToCSS | resources.Minify }}
{{ end }}

{{/* <!-- Page Scripts --> */}}
{{ partial "pancakesBuilder/scripts.html" . | safeHTML }}

{{ if eq $env "staging" }}
  {{/* <!-- Builder UI Components --> */}}
  {{ partial "pancakesBuilder/app/components/drawer.html" . | safeHTML }}
  {{ partial "pancakesBuilder/app/components/modal.html" . | safeHTML }}

  {{/* <!-- Builder JS --> */}}
  {{ partial "pancakesBuilder/app/scripts.html" . | safeHTML }}
{{ end }}


{{- end -}}