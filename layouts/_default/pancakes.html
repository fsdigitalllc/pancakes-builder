{{- define "main" -}}

{{ $env := getenv "HUGO_ENV" }}
{{/* <!-- "staging" "production." Staging is hugo server or user defined env --> */}}

{{ with partial "pancakesBuilder/helpers/getEnvironment.html" . }}
   {{ $env = . }}
{{ end }}
{{ .Scratch.Set "env" $env }}

{{ partial "pancakesBuilder/scripts_critical.html" . | safeHTML }}

{{ if eq $env "staging" }}
  {{ partial "pancakesBuilder/app/styles.html" . | safeHTML }}
{{ end }}


{{/* <!-- Critical CSS --> */}}
{{ .Scratch.Set "generatorType" "gen_criticalcss" }}
<style pancakes-critical class="pb_criticalCSS">
    {{ partial "pancakesBuilder/app/generator/all.html" . | safeCSS }}
    {{ partial "components/component_generator.html" . | safeCSS }}
</style>

{{/* <!-- Page HTML --> */}}
{{ .Scratch.Set "generatorType" "gen_pagehtml" }}
{{- partial "pancakesBuilder/app/generator/all.html" . | safeHTML -}}

{{/* <!-- Page Noncritical CSS --> */}}
{{ $yes := false }}
{{ if $yes }}
  {{ $css := partial "components/component_generator.html" . | safeCSS }}
  {{ $string := print $css }}
  {{ $vars := $css | resources.FromString "scss/pb_noncritical.scss" | resources.ToCSS | resources.Minify }}
{{ end }}


{{ if eq $env "staging" }}
<div class="builderUIComponents">
  {{/* <!-- Builder UI Components --> */}}
  {{ .Scratch.Set "generatorType" "gen_menu_buttons" }}

  {{ partial "pancakesBuilder/app/components/drawer.html" . | safeHTML }}
  {{ partial "pancakesBuilder/app/components/modal.html" . | safeHTML }}
  {{ partial "pancakesBuilder/app/components/modal_full.html" . | safeHTML }}

  

  {{/* <!-- Builder draggable HTML --> */}}
  {{ .Scratch.Set "generatorType" "gen_menu_content" }}
  <div class="pb-template-contentWrapper">
  {{- partial "pancakesBuilder/app/generator/all.html" . | safeHTML -}}
  </div>
  <div class="pb-responsive-wrapper"><iframe class="pbResponsiveFrame" name="Framename" src="" width="600" height="600" frameborder="0" scrolling="auto" class="frame-area"></iframe></div>
</div>


{{ end }}

{{ .Scratch.Set "generatorType" "gen_noncriticalcss" }}


{{/* <!-- Builder JS --> */}}
{{ partial "pancakesBuilder/app/scripts.html" . | safeHTML }}

{{- end -}}